{% extends 'core/base.html' %}
{% block title %}Buy Bundle | RichDataBundles{% endblock %}
{% block content %}
<h2>Buy a Data Bundle</h2>

{% if bundles %}
  <form method="post" class="form" id="buyForm">{% csrf_token %}
    <div class="grid" style="margin-bottom:18px;">
      {% for b in bundles %}
        <label class="bundle-card" style="cursor:pointer; border: 2px solid transparent;">
          <input type="radio" name="bundle_code" value="{{ b.plan }}" style="display:none;">
          <div style="padding:12px;">
            <div class="bundle-head">{{ b.network }} â€¢ {{ b.name }}</div>
            <div class="bundle-price">{{ b.price }} GHS</div>
          </div>
        </label>
      {% endfor %}
    </div>

    <label for="phone_number">Recipient number</label>
    <input type="text" name="phone_number" id="phone_number" class="form-control" placeholder="Enter recipient number" required>

    <button class="btn" type="submit" style="margin-top:12px">Pay & Buy</button>
  </form>

  <script>
    document.addEventListener('click', function(e){
      const card = e.target.closest('.bundle-card');
      if(!card) return;
      document.querySelectorAll('.bundle-card').forEach(c => c.style.border = '2px solid transparent');
      card.style.border = '2px solid #4b0db5';
      const radio = card.querySelector('input[type="radio"]');
      if(radio) radio.checked = true;
    });
  </script>

{% else %}
  <p>No bundles available right now. Please check back later or contact support.</p>
{% endif %}

<p style="margin-top:12px;color:#374151;">Note: Payment is verified with Paystack before a DataDash top-up is requested.</p>
{% endblock %}
