{% extends 'core/base.html' %}
{% load static %}
{% block content %}
<div class="pb-3">
  <h2 class="mb-3">Buy Data Bundle</h2>

  <form method="POST" id="buyForm">
    {% csrf_token %}
    <div class="mb-3">
      <label for="recipient" class="form-label">Recipient Number</label>
      <input id="recipient" name="recipient" type="text" class="form-control" placeholder="054XXXXXXXX" required>
    </div>

    <div class="row g-3">
      {% for bundle in bundles %}
      {% with name_lower=bundle.name|lower %}
      <div class="col-12 col-md-6 col-lg-4">
        <div class="card h-100 bundle-rect" data-id="{{ bundle.id }}">
          <div class="card-body d-flex flex-column">
            <div class="d-flex align-items-center justify-content-between mb-2">
              <div class="fw-bold">{{ bundle.name }}</div>
              <div class="small text-muted">
                {% if 'mtn' in name_lower %}MTN{% elif 'telecel' in name_lower %}Telecel{% elif 'tigo' in name_lower or 'airteltigo' in name_lower %}AirtelTigo{% else %}Other{% endif %}
              </div>
            </div>

            <div class="flex-fill d-flex align-items-end justify-content-between">
              <div>
                <div class="h5 mb-0">â‚µ{{ bundle.price }}</div>
                <div class="text-muted small">Inclusive</div>
              </div>
              <button type="submit" class="btn btn-dark btn-sm buy-btn" name="bundle_id" value="{{ bundle.id }}">Buy</button>
            </div>
          </div>
        </div>
      </div>
      {% endwith %}
      {% empty %}
      <div class="col-12">
        <div class="alert alert-info">No bundles available yet. Please check back soon.</div>
      </div>
      {% endfor %}
    </div>
  </form>
</div>

{% endblock %}
